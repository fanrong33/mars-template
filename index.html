<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>MarsUI</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://cdn.bootcss.com/switchery/0.8.2/switchery.min.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_fxrisq8n6euvunmi.css">
    <link rel="stylesheet" href="home/css/mars.css">
    <style>
        .navbar-fixed-top{
            z-index: 999;
        }
        .changelog-badge{
            position: relative;
            width: 133px;
        }
        .changelog-badge #HW_badge_cont{
            width: 110px;
            height: auto;
        }
        .changelog-badge #HW_badge_cont:before {
            content: "Release notes";
        }
        .changelog-badge #HW_badge {
            position: absolute;
            top: 3px;
            right: 0;
            left: auto;

            background: #fc0d1b;
        }

</style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body><!-- action: .navigator-collapse -->
    
    <nav class="navbar navbar-default navbar-mars navbar-fixed-top" role="navigation">
        <div class="container-fluid">

            <div class="inverse-sidebar" id="toggle_navigator">
                <i class="iconfont icon-hamburger"></i>
            </div>

            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/"><img src="home/images/marsui_logo.png" alt="" height="22px" style="margin-top: 2px;"></a>
            </div>
            

    
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li><a class="changelog-badge"></a></li>
                    <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">fanrong33 <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="#">账号管理</a></li>
                        <li><a href="#">退出</a></li>
                    </ul>
                    </li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>

    
    <div class="page-container">
        
        <div class="page-content">

            <ul class="page-breadcrumb">
                <li><a href="">首页</a></li>
                <span>&gt;</span>
                <li class="active">表格</li>
            </ul>

            <div class="list-page-content">
                <div class="list-view">
                    
                    <div class="list-meta">
                        <div class="list-action">
                            <a class="btn btn-primary" href="form.html"><i class="glyphicon glyphicon-plus" style="width: 14px; height: 14px;"></i> 添加移动应用</a>
                        </div>
                        <div class="list-filter">
                            <form id="form" action="" method="GET">
                                <div class="input-group inline-block" style="width: 250px; vertical-align: middle;">
                                    <input class="form-control" id="keyword" name="keyword" value="" type="text" placeholder="搜索应用名称和ID" autocomplete="off" onkeydown="enter_press(item_manager.get_item_list);" style="width: 210px;font-size: 12px;">
                                    <span class="input-group-btn">
                                        <button class="btn btn-default" type="button" onclick="item_manager.get_item_list();"><i class="glyphicon glyphicon-search" style="width: 14px;height: 14px;color: #999;"></i></button>
                                    </span>
                                </div>
                                
                                <div class="dropdown inline-block" id="status_dropdown">
                                    <button class="btn btn-default dropdown-toggle" type="button" id="status_dropdown_menu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="font-size: 12px;padding-top: 7px;line-height: normal;padding-bottom: 7px;">
                                        全部状态
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="status_dropdown_menu" style="max-height: 200px;overflow-y: auto;font-size: 12px;">
                                        <li><a href="javascript:;">全部状态</a></li>
                                        <li><a href="javascript:;" data-status="1">已通过</a></li>
                                        <li><a href="javascript:;" data-status="0">审核中</a></li>
                                        <li><a href="javascript:;" data-status="-1">未通过</a></li>
                                    </ul>
                                </div>
    

                                <input type="hidden" id="status" name="status" value="" />
                                <input type="hidden" id="order_by" name="order_by" value="" />
                                <input type="hidden" id="direction" name="direction" value="" />

                            </form>
                        </div><!-- .list-filter -->
                    </div><!-- .list-meta -->


                    <table class="table table-hover" id="page_list">
                        <thead>
                            <tr>
                                <th style="width: 36px; text-align: center;">
                                    <input id="select_all_checkbox" name="id[]" type="checkbox" onclick="select_all(this, '#page_list tbody', toggle_btn_display_callback)" value="">
                                </th>
                                <th>名称</th>
                                <th style="width:120px;">平台</th>
                                <th style="width:140px;"><span class="sort " data-order-by="create_time">创建日期</span><!-- .desc .asc --></th>
                                <th style="width:100px;">
                                    联盟状态 <i href="javascript:;" class="tooltip-help" data-toggle="tooltip" data-container="body" data-placement="right" title="代表应用是否可以正常请求百度联盟广告。初始状态为待审核，审核通过后即可正常请求百度联盟广告。">?</i>
                                </th>
                                <th style="width:100px;">启用状态</th>
                                <th style="width:150px;">操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="page_24">
                                <td style="text-align: center;">
                                    <input type="checkbox" name="id[]" value="1" onclick="select_one(this, '#page_list tbody', '#select_all_checkbox', toggle_btn_display_callback)">
                                </td>
                                <td>
                                    <p><a href="">测试应用</a></p>
                                    <span class="text-muted">ID: 823323</span>
                                </td>
                                <td><i class="iconfont icon-apple" style="font-size: 20px;color: #333;"></i></td>
                                <td>2016-12-21</td>
                                <td><span class="text-success">通过</span></td> 
                                <td><input type="checkbox" class="j_switch" data-offer-id="600004" checked ></td>
                                <td>
                                    <a href="/page/edit/id/24.html" style="color: #12bfcd;">修改</a>
                                    <span class="divider">|</span>
                                    <a href="javascript:;" onclick="delete_page(24)" style="color: #ca0808;">删除</a>
                                </td>
                            </tr>
                            <tr id="page_25">
                                <td style="text-align: center;">
                                    <input type="checkbox" name="id[]" value="2" onclick="select_one(this, '#page_list tbody', '#select_all_checkbox', toggle_btn_display_callback)">
                                </td>
                                <td>
                                    <p><a href="">测试应用2</a></p>
                                    <span class="text-muted">ID: 823323</span>
                                </td>
                                <td><i class="iconfont icon-android" style="font-size: 22px;color: #97C03C;"></i></td>
                                <td>2016-12-21</td>
                                <td>未通过 <i href="javascript:;" class="tooltip-help" data-toggle="tooltip" data-container="body" data-placement="bottom" title="拒绝理由：应用信息填写不完整或财务信息未通过审核，请在财务信息通过审核后完善信息，重新编辑发起联盟审核。">?</i></td> 
                                <td><input type="checkbox" class="j_switch" data-offer-id="600004"></td>
                                <td>
                                    <a href="/page/edit/id/24.html" style="color: #12bfcd;">修改</a>
                                    <span class="divider">|</span>
                                    <a href="javascript:;" onclick="delete_page(24)" style="color: #ca0808;">删除</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="clearfix">
                        <div class="pull-left">
                            <button type="submit" class="btn btn-primary btn-sm" id="batch_delete_btn" disabled>批量删除 <span></span></button>
                        </div>
                        <nav class="pull-right">
                            <ul class="pagination" style="margin-top: 0;"><li class='disabled'><a>&laquo;</a></li><li class='active'><a>1</a></li><li><a href='/page/index/p/2.html'>2</a></li><li><a href='/page/index/p/3.html'>3</a></li><li><a>...</a></li><li><a href='/page/index/p/5.html'>5</a></li><li><a href='/page/index/p/2.html' class='next'>&raquo;</a></li></ul>
                        </nav>
                    </div>
                    

                </div><!-- .list-view -->
            </div>

        </div>
        
        
    </div><!-- .page-container -->

    
    <div class="sidebar" id="sidebar">
        <ul class="sidebar-menu">
        
            <li class="sidebar-menu-item">
                <a class="sidebar-menu-section-title" href="dashboard.html">
                    <i class="glyphicon glyphicon-dashboard"></i>
                    <span>仪表盘</span>
                </a>
            </li>
            <li class="sidebar-menu-item sidebar-menu-item-has-child active expand">
                <a class="sidebar-menu-section-title" href="index.html">
                    <i class="glyphicon glyphicon-th-list"></i>
                    <span>表单</span>
                </a>
                <em class="sidebar-drop">
                    <i class="glyphicon glyphicon-chevron-right"></i>
                </em>

                <ul class="sidebar-child-menu">
                    <li><a href="index.html">表格</a></li>
                    <li><a href="form.html">表单</a></li>
                    <li><a href="datetimepicker.html">日历</a></li>
                    <li><a href="bootstrap_select.html">选择框</a></li>
                    <li><a href="tags_autosuggest.html">Tags 输入框</a></li>
                    <li><a href="validate.html">表单验证</a></li>
                    <li><a href="dropzone.html">文件上传</a></li>
                    <li><a href="simditor.html">富编辑器</a></li>
<li><a href="clipboard.html">剪切板</a></li>
                </ul><!-- .sidebar-child-menu -->
            </li><!-- sidebar-menu-item -->
            <li class="sidebar-menu-item sidebar-menu-item-has-child">
                <a class="sidebar-menu-section-title" href="panel.html">
                    <i class="glyphicon glyphicon-comment"></i>
                    <span>基础组件</span>
                </a>
                <em class="sidebar-drop">
                    <i class="glyphicon glyphicon-chevron-right"></i>
                </em>

                <ul class="sidebar-child-menu">
                    <li><a href="panel.html">面板</a></li>
                    <li><a href="nav.html">标签页</a></li>
                    <li><a href="progress.html">进度条</a></li>
                    <li><a href="slide_right_modal.html">侧滑模态框</a></li>
                    <li><a href="gallery.html">图库</a></li>
                </ul><!-- .sidebar-child-menu -->
            </li><!-- sidebar-menu-item -->
            <li class="sidebar-menu-item sidebar-menu-item-has-child">
                <a class="sidebar-menu-section-title" href="modal.html">
                    <i class="glyphicon glyphicon-ok"></i>
                    <span>操作反馈</span>
                </a>
                <em class="sidebar-drop">
                    <i class="glyphicon glyphicon-chevron-right"></i>
                </em>

                <ul class="sidebar-child-menu">
                    <li><a href="modal.html">模态框</a></li>
                    <li><a href="tooltip.html">工具提示</a></li>
                    <li><a href="alert.html">警告框</a></li>
                    <li><a href="toast.html">吐司</a></li>
                </ul><!-- .sidebar-child-menu -->
            </li><!-- sidebar-menu-item -->
            <li class="sidebar-menu-item sidebar-menu-item-has-child">
                <a class="sidebar-menu-section-title" href="line.html">
                    <i class="glyphicon glyphicon-stats"></i>
                    <span>报表</span>
                </a>
                <em class="sidebar-drop">
                    <i class="glyphicon glyphicon-chevron-right"></i>
                </em>

                <ul class="sidebar-child-menu">
                    <li><a href="line.html">折线图</a></li>
                </ul><!-- .sidebar-child-menu -->
            </li><!-- sidebar-menu-item -->
            <li class="sidebar-menu-item sidebar-menu-item-has-child">
                <a class="sidebar-menu-section-title" href="login.html">
                    <i class="glyphicon glyphicon-file"></i>
                    <span>页面</span>
                </a>
                <em class="sidebar-drop">
                    <i class="glyphicon glyphicon-chevron-right"></i>
                </em>

                <ul class="sidebar-child-menu">
                    <li><a href="login.html">登录页面</a></li>
                    <li><a href="login_fullscreen.html">登录页面(全屏)</a></li>
                    <li><a href="register.html">注册页面</a></li>
                    <li><a href="edit_password.html">修改密码</a></li>
                    <li><a href="stats.html">统计报告</a></li>
                    <li><a href="msg.html">提示页</a></li>
                </ul><!-- .sidebar-child-menu -->
            </li><!-- sidebar-menu-item -->

        
        </ul>
    </div><!-- .sidebar -->
    

    <script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="//cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script src="//cdn.bootcss.com/switchery/0.8.2/switchery.min.js"></script>
    <script src="//cdn.headwayapp.co/widget.js"></script>
    <script>
    var HW_config = {
        selector: ".changelog-badge", // CSS selector where to inject the badge
        account: "7zpWKy" // your account ID
    };
    Headway.init(HW_config);
    </script>
    <script>
    $(document).ready(function(){

        // 绑定折叠侧边菜单栏事件
        $("#toggle_navigator").click(function(){
            $(this).toggleClass('fold');

            $("body").toggleClass('navigator-collapse');
        });

        // 侧边菜单箭头事件绑定
        $("#sidebar .sidebar-drop").click(function(){
            if(!$(this).parent().hasClass('expand')){
                $("#sidebar .sidebar-menu-item.expand").removeClass('expand');
            }

            $(this).parent().toggleClass('expand');
        });



        // group dropdown click event
        $("#status_dropdown .dropdown-menu").delegate("a", 'click', function(){
            var status_text = $(this).text();
            var status      = $(this).data('status');

            $("#status_dropdown button").html(status_text+' <span class="caret"></span>');
            $("#status").val(status);
            $("#form").submit();
        });


        // bind sort event
        $("#page_list").delegate('.sort', 'click', function(){
            var $this = $(this);
            if($this.hasClass('desc')){
                $this.removeClass('desc').addClass('asc');
                // asc
                $("#order_by").val($this.data('order-by'));
                $("#direction").val('asc');
            }else{
                // if($this.hasClass('asc')){
                //     $this.removeClass('asc');
                //     // default
                //     $("#order_by").val('');
                //     $("#direction").val('');
                // }else{
                    $this.removeClass('asc').addClass('desc');
                    // desc
                    $("#order_by").val($this.data('order-by'));
                    $("#direction").val('desc');
                // }
            }

            $("#form").submit();
        });


        $('.tooltip-help').tooltip();


        // var checkbox_elem = document.querySelector('.j_switch');
        // var switchery = new Switchery(checkbox_elem, { size: 'small' });

        var elems = Array.prototype.slice.call(document.querySelectorAll('.j_switch'));

        elems.forEach(function(checkbox_elem) {
          var switchery = new Switchery(checkbox_elem, { color: '#12bdce', size: 'small' });
        });

        $(document).delegate(".j_switch", "change", function(){

            var offer_id   = $(this).data('offer-id');
            var is_actived = 0;

            var checkbox_elem = $(this).get(0);
            if(checkbox_elem.checked){
                is_actived = 1;
            }

            var params = { };
            params['offer_id']   = offer_id;
            params['is_actived'] = is_actived;
            $.ajax({
                type: "POST",
                url: "/offer/toggle_status.html",
                data: params,
                dataType: "json",
                success: function(json){
                    if(json.status == 1){

                    }else{
                        toastr.error(json.info);
                    }
                }
            });
        });



        if(window.location.hash){
            $(window.location.hash).addClass('highlight-fade');
        }
    });



    function delete_page(id){
        if(confirm('确定删除？')){
            $.ajax({
                type: "POST",
                url: "/page/delete",
                data: { page_id: id },
                dataType: "json",
                success: function(json){
                    if(json.status == 1){
                        $("#page_"+id).remove();

                        toastr.success(json.info);
                    }else{
                        toastr.error(json.info);
                    }
                }
            });
        }
    }


    /**
     * checkbox全选
     * @param  {Dom}       obj         dom对象，一般传入this
     * @param  {String}    container   子checkbox容器节点，例如'#item_list tbody'
     * @param  {Function}  callback    回调函数，例如选中后，处理'从列表下架'按钮的显示 toggle_display_callback: function(is_checked)
     * @author 蔡繁荣
     * @version 1.0.2 build 20170225
     */
    function select_all(obj, container, callback){
        var is_checked = obj.checked;
        var name = obj.name;
        name = name.replace('[]', '');

        if(name == ''){
            alert('input必须包含name属性');
            return;
        }

        $(container + " input[name^="+name+"]:checkbox:enabled").each(function(){
            this.checked = is_checked;
        });

        var checked = $(container+" input[name^="+name+"]:checkbox:checked:enabled").length;

        callback && callback(checked);
    }

    /**
     * 表格行内-选中单个checkbox
     * @param  {Dom}      obj           dom对象，一般传入this
     * @param  {String}   container     子checkbox容器节点，例如'#item_list tbody'
     * @param  {String}   all_checkbox  全选checkbox节点，例如'#select_all_checkbox'
     * @param  {Function} callback      回调函数，例如选中后，处理‘从列表下架’按钮的显示
     * @author 蔡繁荣
     * @version 1.0.2 build 20170225
     */
    function select_one(obj, container, all_checkbox, callback){
        var is_checked = obj.checked;
        var name = obj.name;
        name = name.replace('[]', '');

        if(name == ''){
            alert('input必须包含name属性');
            return;
        }

        var total   = $(container+" input[name^="+name+"]:checkbox:enabled").length;
        var checked = $(container+" input[name^="+name+"]:checkbox:checked:enabled").length;


        if(is_checked){
            // 选中了，如果全部选中，则同时选中'全选'的那个input
            if(checked == total){
                $(all_checkbox).get(0).checked = true;
            }
        }else{
            // 取消选择，肯定取消'全选'的那个input
            $(all_checkbox).get(0).checked = false;
        }
        // 判断选中的个数，如果大于0，则启用”从列表下架“按钮，否则禁用”从列表下架按钮“
        
        callback && callback(checked);
    }

    
    // 开关”从列表下架“回调
    function toggle_btn_display_callback(checked){
        if(checked > 0){
            // 设置从列表下架按钮启用
            $("#batch_delete_btn").removeAttr('disabled').find('span').text('('+checked+')');
        }else{
            // 设置从列表下架按钮禁用
            $("#batch_delete_btn").attr('disabled', '').find('span').text('');
        }
    }
    </script>
</body>
</html>